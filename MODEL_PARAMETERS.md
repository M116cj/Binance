# 加密货币涨跌预测系统 - 决策模型参数说明

## 概述
本系统使用多层决策框架，基于概率预测和成本效用分析生成交易信号。

---

## 核心参数体系

### 1. 价格标记参数 (Triple Barrier Labeling)

#### θ_up (上涨判定线) 
- **英文名**: theta_up
- **默认值**: 0.006 (0.6%)
- **建议范围**: 0.003 - 0.010 (0.3% - 1.0%)
- **含义**: 价格上涨达到此幅度才标记为"上涨"
- **用途**: 训练数据标记、回测评估
- **调整建议**:
  - 波动大的币种可设置为0.8%-1.0%
  - 波动小的币种可设置为0.3%-0.5%
  - 当前UI默认: 0.6%

#### θ_dn (下跌判定线)
- **英文名**: theta_dn  
- **默认值**: 0.004 (0.4%)
- **建议范围**: 0.002 - 0.006 (0.2% - 0.6%)
- **含义**: 价格下跌达到此幅度才标记为"下跌"
- **用途**: 训练数据标记、回测评估
- **调整建议**:
  - 通常设置为θ_up的60%-70%
  - 当前UI默认: 0.4%

---

### 2. 决策阈值参数 (Decision Thresholds)

#### τ (概率阈值 / 信心度要求)
- **英文名**: tau_threshold
- **含义**: 预测概率必须达到此值才发出信号
- **策略层级**:
  - **🛡️ 保守型 (Conservative)**: τ = 0.75 (75%)
  - **⚖️ 平衡型 (Balanced)**: τ = 0.65 (65%)  
  - **🔥 激进型 (Aggressive)**: τ = 0.55 (55%)
- **用途**: 过滤低置信度预测
- **影响**: 值越高，信号越少但质量越高

#### κ (效用阈值 / 收益要求)
- **英文名**: kappa_threshold
- **含义**: 预期收益必须是成本的κ倍以上
- **策略层级**:
  - **🛡️ 保守型**: κ = 1.20 (预期收益≥成本的1.2倍)
  - **⚖️ 平衡型**: κ = 1.00 (预期收益≥成本)
  - **🔥 激进型**: κ = 0.80 (允许收益略低于成本)
- **用途**: 考虑交易成本后的盈利性过滤
- **影响**: 值越高，要求预期收益越大

---

### 3. 时间窗口参数 (Time Horizons)

#### horizon_minutes
- **默认值**: [5, 10, 30]
- **含义**: 预测的时间窗口（分钟）
- **说明**:
  - 5分钟: 超短线交易
  - 10分钟: 短线交易
  - 30分钟: 中短线交易
- **调整建议**: 可根据交易风格选择1-3个时间窗口

---

### 4. 模型层级参数 (Model Tier Thresholds)

系统使用两级信号分类：

#### A级信号 (高质量)
- **概率阈值**: τ = 0.75
- **效用阈值**: κ = 1.20
- **特点**: 高确定性、高预期收益

#### B级信号 (中等质量)
- **概率阈值**: τ = 0.65
- **效用阈值**: κ = 1.00
- **特点**: 中等确定性、合理收益

---

## 参数组合策略

### 🛡️ 保守型策略 (Conservative)
```python
theta_up = 0.006        # 0.6%
theta_dn = 0.004        # 0.4%
tau = 0.75              # 75%
kappa = 1.20            # 1.2倍
```
- **特点**: 高质量信号，频率低
- **适合**: 风险厌恶型交易者
- **预期**: 胜率高，交易次数少

### ⚖️ 平衡型策略 (Balanced)
```python
theta_up = 0.006        # 0.6%
theta_dn = 0.004        # 0.4%
tau = 0.65              # 65%
kappa = 1.00            # 1.0倍
```
- **特点**: 质量与频率平衡
- **适合**: 一般交易者（推荐）
- **预期**: 合理胜率，适中频率

### 🔥 激进型策略 (Aggressive)
```python
theta_up = 0.006        # 0.6%
theta_dn = 0.004        # 0.4%
tau = 0.55              # 55%
kappa = 0.80            # 0.8倍
```
- **特点**: 更多交易机会
- **适合**: 风险偏好型交易者
- **预期**: 胜率较低，交易频繁

---

## 其他重要参数

### 训练参数 (Training Config)
```python
focal_gamma = 1.5              # Focal Loss gamma参数
calibration_method = "isotonic" # 校准方法
calibration_ece = 0.04         # 期望校准误差
```

### 回测参数 (Backtest Config)
```python
days_back = 30                 # 回测天数
enable_embargo = True          # 启用禁入期
cooldown_minutes = 10-30       # 冷却期（分钟）
```

### 质量指标 (Quality Metrics)
```python
pr_auc = 0.72                  # PR曲线下面积
hit_at_top_k = 0.65            # Top-K命中率
```

---

## 参数调整建议

### 1. 提高信号质量
- ↑ 增加 τ (例如: 0.65 → 0.75)
- ↑ 增加 κ (例如: 1.0 → 1.2)
- ↑ 增加 θ_up, θ_dn

### 2. 增加信号数量
- ↓ 降低 τ (例如: 0.75 → 0.65)
- ↓ 降低 κ (例如: 1.2 → 1.0)
- ↓ 降低 θ_up, θ_dn

### 3. 适应高波动市场
- ↑ 增加 θ_up, θ_dn (例如: 0.6% → 1.0%)
- 保持 τ 不变或略微降低

### 4. 适应低波动市场
- ↓ 降低 θ_up, θ_dn (例如: 0.6% → 0.3%)
- 保持 τ 不变或略微提高

---

## 实时调整位置

### UI侧边栏参数
- **上涨判定线**: 可调整 θ_up
- **下跌判定线**: 可调整 θ_dn  
- **策略选择**: 自动设置 τ 和 κ
  - 保守型 / 平衡型 / 激进型

### 代码配置位置
- `main.py`: UI默认值和会话状态
- `backend/api_server.py`: 模型版本配置
- `backend/inference_service.py`: 层级阈值定义
- `backend/models/labeling.py`: 训练标记参数

---

## 监控指标

建议监控以下指标以优化参数：

1. **信号频率**: 每天生成的信号数量
2. **胜率**: 盈利信号占比
3. **收益成本比**: 实际收益与成本的比率
4. **夏普比率**: 风险调整后收益
5. **最大回撤**: 最大连续亏损

---

## 版本信息

- **模型版本**: 1.0.0
- **特征版本**: 1.0.0
- **成本模型版本**: v1.2.0
- **文档更新**: 2025-10-21
